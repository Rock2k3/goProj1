## Диаграмма окружения сценария

### 1. Родительские сценарии
На диаграмме окружения в родительских сценариях отображаем в случае если в триггерах нашего сценария есть триггер с атрибутами:
source_activity_type: ACTIVITY_INIT
source_scenario_state: INITIATED

### 2. Дочерние сценарии
Сценарии, которые являются дочерними по отношению к нашему сценарию.
На диаграмме окружения дочерними сценариями считаем сценарии если в триггерах внешнего сценария есть триггер с атрибутами:
source/source_scenario будут идентификаторы нашего ВВВ/сценария
source_activity_type: ACTIVITY_INIT
source_scenario_state: INITIATED

### 3. Предшествующие сценарии
Внешние сценарии запускают наш, но не являются родительскими в activity логике.
Критерии отбора сценариев в данный блок:
в automated_capability.DES.scenarios.integrations_used.source указан наш ВВВ
в automated_capability.DES.scenarios.integrations_used.source_business_api — наш business api который использует внешний сценарий.
найденный business_api должен быть у нашего сценария в  automated_capability.DES.scenarios.triggerGroups.triggerItems.event.title
т.е. прописан как триггер, который запускает наш сценарий.

### 4. Последующие сценарии
Внешние сценарии, которые запускаем мы, но не являемся родительским в activity логике.
Критерии отбора.
Из интеграций нашего сценария отбираем:
automated_capability.DES.scenarios.integrations_used.source — ВВВ с которым мы интегрированы
automated_capability.DES.scenarios.integrations_used.source_business_api — business api внешнего сценария, который используем
Если найденный source_business_api в ВВВ у внешнего сценария указан в automated_capability.DES.scenarios.triggerGroups.triggerItems.event.title,
то выводим его как последующий, поскольку вызов с нашей стороны этого business_api приводит к запуску
внешнего сценария.

### 5. Интеграции с нашим сценарием
Здесь выводим все взаимодействия внешнего сценария в ходе работы с нашим. Кроме случаев когда внешний сценарий запускает наш.
Критерии отбора:
Отбираем из integration used внешних сценариев все взаимодействия с нашим.
Отфильтровываются взаимодействия, если у нашего сценария они присутствуют в триггерах и запускают наш сценарий.

### 6. Интеграции с внешними сценариями/BBB
Здесь выводим все взаимодействия нашего сценария в ходе работы с внешними. Кроме случаев когда наш сценарий запускает внешний сценарий.
Критерии отбора:
Отбираем из integration used нашего сценария все взаимодействия с внешними сценариями.
Отфильтровываются взаимодействия, если у внешнего сценария они присутствуют в триггерах и запускают внешний сценарий.
